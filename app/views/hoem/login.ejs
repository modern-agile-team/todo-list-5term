<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>todolist</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript">
        function addList()  {
        const addValue 
        = document.getElementById('addValue').value;
        const li = document.createElement("li");
        li.setAttribute('id',addValue);
        const textNode = document.createTextNode(addValue);
        li.appendChild(textNode);
        document
        .getElementById('list')
        .appendChild(li);

        }
        // function removeItem()  {
        // const ul = document
        //     .getElementById('list');
        // const items = ul.getElementsByTagName('li');
        // if(items.length > 0)  {
        //     items[0].remove();
        // }
        
        // }
        const containerBox = document.querySelector("#containerBox"),
            contents = containerBox.querySelector("#contents"),
            list = contents.querySelector("#list"),
            inputList = document.querySelector(".inputlist"),
            listForm = inputList.querySelector("#listForm"),
            input = listForm.querySelector("input");
        const list_LS = "toDos";

        let toDos = [];

        function saveList(){
            localStorage.setItem(list_LS, JSON.stringify(toDos));
        }

        function deleteList(event){
            const btn = event.target;
            const li = btn.parentNode;
            list.removeChild(li);
            const cleanList = toDos.filter(function(toDo){
                return toDo.id !== parseInt(li.id);
            });
            toDos = cleanList;
            saveList();
        }

        function showingList(text){
            const li = document.createElement("li");
            const delbtn = document.createElement("button");
            const span = document.createElement("span");
            const listNum = toDos.length+1;
            delbtn.innerText = "(지우기)";
            delbtn.addEventListener("click", deleteList);
            span.innerText = text;
            list.appendChild(li);
            li.appendChild(span);
            li.appendChild(delbtn);
            li.id = listNum;
            const toDoObj = {
                text: text,
                id: listNum
            };
            toDos.push(toDoObj);
            saveList();
        }

        function handleSubmit(event){
            event.preventDefault();
            const currentValue = input.value;
            showingList(currentValue);
            input.value = "";
        }

        function loadList(){
            const loadedList = localStorage.getItem(list_LS);
            if(loadedList !== null){
                const parsedData = JSON.parse(loadedList);
                parsedData.forEach(function(toDo){
                    showingList(toDo.text);
                });
            }
        }

        function init(){
            loadList();
            listForm.addEventListener("submit", handleSubmit);
        }

        init();
    </script>
</head>
<body>
    <div>
        <h1>ToDoListTitle</h1>
        <!-- <form action="/add_list" method="post"> -->  
        <div class="inputlist"> 
            <form  id="listForm">
                <input type='text' id='addValue' />
                <input type='button' value='+' onclick='addList()' />
            </form>
        </div>   
        <ul id='list'>
           
        </ul>

        </div>
    </form>

</body>
<!-- 
<li>
    <div>
        <input type="checkbox">
        <span class="material-symbols-outlined">edit</span>
        <span class="material-symbols-outlined">delete</span>
                <input type='button' value='삭제' onclick='removeItem()' />
    </div>
</li> -->